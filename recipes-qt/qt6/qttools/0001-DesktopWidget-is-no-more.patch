From 0460bcf1b99ea640c2bb25e46c85c41f631c1dc6 Mon Sep 17 00:00:00 2001
From: Samuli Piippo <samuli.piippo@qt.io>
Date: Tue, 9 Jun 2020 11:57:28 +0300
Subject: [PATCH] DesktopWidget is no more

Change-Id: Iaee232b831b46db43930b14e9b0dc9706e6d01eb
---
 src/designer/src/designer/qdesigner_actions.cpp    | 1 -
 src/designer/src/lib/shared/deviceprofile.cpp      | 3 +--
 src/designer/src/lib/shared/newformwidget.cpp      | 1 -
 src/designer/src/lib/shared/selectsignaldialog.cpp | 1 -
 src/linguist/linguist/mainwindow.cpp               | 1 -
 src/pixeltool/qpixeltool.cpp                       | 3 +--
 6 files changed, 2 insertions(+), 8 deletions(-)

diff --git a/src/designer/src/designer/qdesigner_actions.cpp b/src/designer/src/designer/qdesigner_actions.cpp
index cf404d51..e0a7d713 100644
--- a/src/designer/src/designer/qdesigner_actions.cpp
+++ b/src/designer/src/designer/qdesigner_actions.cpp
@@ -67,7 +67,6 @@
 #include <QtWidgets/qmdisubwindow.h>
 #include <QtWidgets/qpushbutton.h>
 #include <QtWidgets/qstatusbar.h>
-#include <QtWidgets/qdesktopwidget.h>
 
 #include <QtGui/qaction.h>
 #include <QtGui/qactiongroup.h>
diff --git a/src/designer/src/lib/shared/deviceprofile.cpp b/src/designer/src/lib/shared/deviceprofile.cpp
index c2df77ff..a8a28118 100644
--- a/src/designer/src/lib/shared/deviceprofile.cpp
+++ b/src/designer/src/lib/shared/deviceprofile.cpp
@@ -34,7 +34,6 @@
 
 #include <QtWidgets/qapplication.h>
 #include <QtGui/qfont.h>
-#include <QtWidgets/qdesktopwidget.h>
 #include <QtWidgets/qstyle.h>
 #include <QtWidgets/qstylefactory.h>
 #include <QtWidgets/qapplication.h>
@@ -202,7 +201,7 @@ void DeviceProfile::setName(const QString &n)
 
 void DeviceProfile::systemResolution(int *dpiX, int *dpiY)
 {
-    const QDesktopWidget *dw = qApp->desktop();
+    const QWidget *dw = qApp->desktop();
     *dpiX = dw->logicalDpiX();
     *dpiY = dw->logicalDpiY();
 }
diff --git a/src/designer/src/lib/shared/newformwidget.cpp b/src/designer/src/lib/shared/newformwidget.cpp
index f5cae7fc..bef69726 100644
--- a/src/designer/src/lib/shared/newformwidget.cpp
+++ b/src/designer/src/lib/shared/newformwidget.cpp
@@ -49,7 +49,6 @@
 #include <QtCore/qtextstream.h>
 
 #include <QtWidgets/qapplication.h>
-#include <QtWidgets/qdesktopwidget.h>
 #include <QtWidgets/qheaderview.h>
 #include <QtWidgets/qtreewidget.h>
 #include <QtGui/qpainter.h>
diff --git a/src/designer/src/lib/shared/selectsignaldialog.cpp b/src/designer/src/lib/shared/selectsignaldialog.cpp
index f7308f0f..f19f86cd 100644
--- a/src/designer/src/lib/shared/selectsignaldialog.cpp
+++ b/src/designer/src/lib/shared/selectsignaldialog.cpp
@@ -38,7 +38,6 @@
 #include "widgetdatabase_p.h"
 
 #include <QtWidgets/qapplication.h>
-#include <QtWidgets/qdesktopwidget.h>
 #include <QtWidgets/qpushbutton.h>
 #include <QtGui/qstandarditemmodel.h>
 #include <QtGui/qscreen.h>
diff --git a/src/linguist/linguist/mainwindow.cpp b/src/linguist/linguist/mainwindow.cpp
index 5f455815..06b2da9f 100644
--- a/src/linguist/linguist/mainwindow.cpp
+++ b/src/linguist/linguist/mainwindow.cpp
@@ -54,7 +54,6 @@
 #include <QBitmap>
 #include <QCloseEvent>
 #include <QDebug>
-#include <QDesktopWidget>
 #include <QDockWidget>
 #include <QFile>
 #include <QFileDialog>
diff --git a/src/pixeltool/qpixeltool.cpp b/src/pixeltool/qpixeltool.cpp
index a52a828c..97fd3d4c 100644
--- a/src/pixeltool/qpixeltool.cpp
+++ b/src/pixeltool/qpixeltool.cpp
@@ -29,7 +29,6 @@
 #include "qpixeltool.h"
 
 #include <qapplication.h>
-#include <qdesktopwidget.h>
 #include <qdir.h>
 #include <qapplication.h>
 #include <qscreen.h>
@@ -534,7 +533,7 @@ void QPixelTool::grabScreen()
     int y = mousePos.y() - h/2;
 
     const QBrush darkBrush = palette().color(QPalette::Dark);
-    const QDesktopWidget *desktopWidget = QApplication::desktop();
+    const QWidget *desktopWidget = QApplication::desktop();
     if (QScreen *screen = this->screen()) {
         m_buffer = screen->grabWindow(desktopWidget->winId(), x, y, w, h);
     } else {
-- 
2.25.1

